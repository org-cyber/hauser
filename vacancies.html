<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Premium Vacancies - Hauser NG</title>

<!-- SwiperJS CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root {
  --primary: #0f172a;
  --primary-dark: #0a1120;
  --primary-light: #1e293b;
  --accent: #f97316;
  --accent-dark: #ea580c;
  --accent-light: #fb923c;
  --text-primary: #f1f5f9;
  --text-secondary: #cbd5e1;
  --text-muted: #94a3b8;
  --bg-primary: #0f172a;
  --bg-secondary: #1e293b;
  --border: #334155;
  --success: #22c55e;
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.25);
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
  --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
  --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.35), 0 10px 10px -5px rgba(0, 0, 0, 0.15);
  --radius-sm: 0.25rem;
  --radius: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: var(--text-primary);
  min-height: 100vh;
  line-height: 1.6;
  position: relative;
  overflow-x: hidden;
}

body::before {
  content: '';
  position: absolute; inset: 0;
  background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="15" cy="15" r="1.5" fill="%23cbd5e1" opacity="0.1"><animate attributeName="opacity" values="0.1;0.3;0.1" dur="4s" repeatCount="indefinite"/></circle><circle cx="85" cy="35" r="1" fill="%23cbd5e1" opacity="0.1"><animate attributeName="opacity" values="0.1;0.4;0.1" dur="5s" repeatCount="indefinite"/></circle><circle cx="45" cy="85" r="2" fill="%23cbd5e1" opacity="0.1"><animate attributeName="opacity" values="0.1;0.2;0.1" dur="6s" repeatCount="indefinite"/></circle></svg>');
  animation: float 20s ease-in-out infinite;
  pointer-events: none; z-index: -1;
}
@keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-20px)} }

/* Header */
.header {
  background: linear-gradient(90deg, rgba(30,41,59,.95) 0%, rgba(15,23,42,.9) 100%);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
  box-shadow: var(--shadow-lg);
  padding: 1rem 0; position: sticky; top: 0; z-index: 100;
}
.header-container {
  max-width: 1200px; margin: 0 auto; padding: 0 1.5rem;
  display: flex; justify-content: space-between; align-items: center;
}
.logo-section { display: flex; align-items: center; gap: 1rem; }
.logo-img { height: 50px; border-radius: var(--radius); box-shadow: 0 4px 20px rgba(249,115,22,.3); }
.logo-text {
  font-size: 1.8rem; font-weight: bold;
  background: linear-gradient(to right, var(--text-primary), var(--accent-light));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.nav-menu { display: flex; align-items: center; gap: 1.5rem; }
.nav-link {
  color: var(--text-secondary); text-decoration: none; font-weight: 500;
  padding: .5rem 1rem; border-radius: var(--radius); transition: var(--transition);
  display: flex; align-items: center; gap: .5rem;
}
.nav-link:hover { color: var(--accent); background: rgba(255,255,255,.1); }
.nav-link i { font-size: 1.1rem; }
.login-btn {
  background: rgba(249,115,22,.2); color: var(--accent); border: 1px solid var(--accent);
  border-radius: var(--radius); padding: .6rem 1.2rem; font-weight: 500; cursor: pointer;
  transition: var(--transition); display: inline-flex; align-items: center; gap: .5rem; text-decoration: none;
}
.login-btn:hover { background: rgba(249,115,22,.3); transform: translateY(-2px); }

/* Main Layout */
.container { max-width: 1200px; margin: 2rem auto; padding: 0 1.5rem; }
.page-header { text-align: center; margin-bottom: 2.5rem; padding: 1rem; }
.page-title {
  font-size: 2.5rem; font-weight: bold; margin-bottom: .5rem;
  background: linear-gradient(to right, var(--text-primary), var(--accent));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.page-subtitle { color: var(--text-secondary); font-size: 1.125rem; max-width: 700px; margin: 0 auto; }

.content-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 2rem; }
@media (max-width:1024px){ .content-grid{ grid-template-columns: 1fr; } }

/* Filter Sidebar */
.filter-sidebar {
  background: linear-gradient(135deg, rgba(30,41,59,.7) 0%, rgba(15,23,42,.5) 100%);
  backdrop-filter: blur(10px); border: 1px solid var(--border); border-radius: var(--radius-xl);
  padding: 1.5rem; box-shadow: var(--shadow-md); height: fit-content; position: sticky; top: 100px;
}
.filter-header { margin-bottom: 1.5rem; display: flex; align-items: center; gap: 1rem; }
.filter-header i { color: var(--accent); font-size: 1.5rem; }
.filter-title { font-size: 1.5rem; font-weight: bold; }
.filter-group { margin-bottom: 1.5rem; }
.filter-label { display: block; margin-bottom: .5rem; font-weight: 500; color: var(--text-primary); }
.filter-input {
  width: 100%; padding: .75rem 1rem; background: rgba(15,23,42,.5);
  border: 1px solid var(--border); border-radius: var(--radius); color: var(--text-primary); font-size: 1rem;
  transition: var(--transition);
}
.filter-input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(249,115,22,.1); }
.filter-input::placeholder { color: var(--text-muted); }
.search-btn {
  width: 100%; padding: .9rem; background: var(--accent); color: #fff; border: none; border-radius: var(--radius);
  font-weight: 600; font-size: 1rem; cursor: pointer; transition: var(--transition);
  display: flex; align-items: center; justify-content: center; gap: .5rem;
}
.search-btn:hover { background: var(--accent-dark); transform: translateY(-2px); box-shadow: 0 4px 15px rgba(249,115,22,.3); }

/* Property Grid */
.property-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px,1fr)); gap: 1.5rem; }
.property-card {
  background: linear-gradient(135deg, rgba(30,41,59,.7) 0%, rgba(15,23,42,.5) 100%);
  backdrop-filter: blur(8px); border: 1px solid var(--border); border-radius: var(--radius-lg);
  overflow: hidden; box-shadow: var(--shadow-sm); transition: var(--transition); position: relative;
}
.property-card::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background: var(--accent); }
.property-card:hover { transform: translateY(-5px); box-shadow: var(--shadow); border-color: var(--accent); }
.property-media { height: 250px; position: relative; overflow: hidden; }
.swiper { width: 100%; height: 100%; }
.swiper-slide { display: flex; justify-content: center; align-items: center; }
.swiper-slide img, .swiper-slide video { width: 100%; height: 100%; object-fit: cover; }
.property-details { padding: 1.5rem; }
.property-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: .5rem; }
.property-title { font-size: 1.25rem; font-weight: bold; margin-right: .5rem; }
.verified-badge { background: var(--success); color: #fff; font-size: .75rem; padding: .25rem .5rem; border-radius: var(--radius-sm); display: inline-block; }
.property-price { font-size: 1.5rem; font-weight: bold; color: var(--accent); margin-bottom: .5rem; }
.property-location { display: flex; align-items: center; gap: .5rem; margin-bottom: 1rem; color: var(--text-secondary); }
.property-location i { color: var(--accent); }
.property-description {
  color: var(--text-secondary); margin-bottom: 1rem; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
}
.read-more { color: var(--accent); font-weight: 500; text-decoration: none; display:inline-flex; align-items:center; gap:.5rem; cursor:pointer; transition: var(--transition); }
.read-more:hover { color: var(--accent-light); }
.extra-details {
  padding: 1rem; background: rgba(15,23,42,.5); border-top: 1px solid var(--border);
  border-radius: 0 0 var(--radius-lg) var(--radius-lg); margin-top: .5rem; display: none;
}

/* Responsive */
@media (max-width:768px){
  .header-container{ flex-direction: column; gap: 1rem; text-align:center; }
  .nav-menu{ flex-wrap: wrap; justify-content: center; }
  .page-title{ font-size: 2rem; }
  .property-grid{ grid-template-columns: 1fr; }
  .filter-sidebar{ position: relative; top: 0; }
}
@media (max-width:480px){
  .logo-text{ font-size: 1.5rem; }
  .page-title{ font-size: 1.8rem; }
}

/* Utils */
.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}
.mb-1{margin-bottom:.25rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}
</style>
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="header-container">
    <div class="logo-section">
      <div class="logo-img-placeholder" style="width:50px;height:50px;background:#f97316;border-radius:8px;"></div>
      <h1 class="logo-text">Hauser NG</h1>
    </div>
    <nav class="nav-menu">
      <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Home</a>
      <a href="about-us.html" class="nav-link"><i class="fas fa-info-circle"></i> About</a>
      <a href="vacancies.html" class="nav-link active"><i class="fas fa-search"></i> Find a Home</a>
      <a href="login.html" class="login-btn"><i class="fas fa-sign-in-alt"></i> Login</a>
      <a href="signup.html" class="login-btn"><i class="fas fa-user-plus"></i> Sign Up</a>
    </nav>
  </div>
</header>

<!-- Main -->
<main class="container">
  <div class="page-header">
    <h2 class="page-title">Premium Vacancies</h2>
    <p class="page-subtitle">Discover verified properties and premium listings across Nigeria</p>
  </div>

  <div class="content-grid">
    <!-- Filter Sidebar -->
    <aside class="filter-sidebar">
      <div class="filter-header">
        <i class="fas fa-filter"></i>
        <h3 class="filter-title">Filter Properties</h3>
      </div>

      <form class="search-form" onsubmit="return false;">
        <div class="filter-group">
          <label class="filter-label">Search by Title or Keyword</label>
          <input type="text" id="searchInput" class="filter-input" placeholder="e.g. Duplex, Apartment...">
        </div>

        <div class="filter-group">
          <label class="filter-label">Max Price (₦)</label>
          <input type="number" id="priceInput" class="filter-input" placeholder="Enter max price">
        </div>

        <!-- Filter by Location -->
        <div class="filter-group">
          <label class="filter-label">Filter by Location</label>

          <!-- State Dropdown -->
          <select id="stateInput" class="filter-input">
            <option value="" selected>All States</option>
            <option value="abia">Abia</option>
            <option value="adamawa">Adamawa</option>
            <option value="akwa-ibom">Akwa Ibom</option>
            <option value="anambra">Anambra</option>
            <option value="bauchi">Bauchi</option>
            <option value="bayelsa">Bayelsa</option>
            <option value="benue">Benue</option>
            <option value="borno">Borno</option>
            <option value="cross-river">Cross River</option>
            <option value="delta">Delta</option>
            <option value="ebonyi">Ebonyi</option>
            <option value="edo">Edo</option>
            <option value="ekiti">Ekiti</option>
            <option value="enugu">Enugu</option>
            <option value="fct">FCT (Abuja)</option>
            <option value="gombe">Gombe</option>
            <option value="imo">Imo</option>
            <option value="jigawa">Jigawa</option>
            <option value="kaduna">Kaduna</option>
            <option value="kano">Kano</option>
            <option value="katsina">Katsina</option>
            <option value="kebbi">Kebbi</option>
            <option value="kogi">Kogi</option>
            <option value="kwara">Kwara</option>
            <option value="lagos">Lagos</option>
            <option value="nasarawa">Nasarawa</option>
            <option value="niger">Niger</option>
            <option value="ogun">Ogun</option>
            <option value="ondo">Ondo</option>
            <option value="osun">Osun</option>
            <option value="oyo">Oyo</option>
            <option value="plateau">Plateau</option>
            <option value="rivers">Rivers</option>
            <option value="sokoto">Sokoto</option>
            <option value="taraba">Taraba</option>
            <option value="yobe">Yobe</option>
            <option value="zamfara">Zamfara</option>
          </select>

          <!-- LGA Dropdown -->
          <select id="locationInput" class="filter-input" disabled>
            <option value="" selected>All LGAs</option>
          </select>
        </div>

        <button class="search-btn" type="button">
          <i class="fas fa-search"></i> Search Properties
        </button>
      </form>
    </aside>

    <!-- Property Listings -->
    <div class="property-grid" id="blogList"></div>
  </div>
</main>

<!-- SwiperJS JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAHqg_u1DwWUB9l1vuoYDLKjCJl5Xx7Pbo",
    authDomain: "hauserng-77cc2.firebaseapp.com",
    projectId: "hauserng-77cc2",
    storageBucket: "hauserng-77cc2.appspot.com",
    messagingSenderId: "613578175402",
    appId: "1:613578175402:web:db7413f898987ac6a1f1d3"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const blogList = document.getElementById('blogList');
  const searchInput = document.getElementById('searchInput');
  const priceInput = document.getElementById('priceInput');
  const locationInput = document.getElementById('locationInput'); // LGA select
  const stateInput = document.getElementById('stateInput');       // State select
  const searchBtn = document.querySelector('.search-btn');

  let allProperties = [];

  // Safer details toggler (uses computed style)
  function toggleDetails(id) {
    const el = document.getElementById(id);
    const current = window.getComputedStyle(el).display;
    el.style.display = (current === "none") ? "block" : "none";
  }

  function renderProperties(list) {
    blogList.innerHTML = '';

    if (list.length === 0) {
      blogList.innerHTML = `
        <div class="no-results" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
          <i class="fas fa-search" style="font-size: 3rem; color: var(--accent); margin-bottom: 1rem;"></i>
          <h3 style="color: var(--text-primary);">No properties found</h3>
          <p style="color: var(--text-secondary);">Try adjusting your search filters</p>
        </div>
      `;
      return;
    }

    list.forEach((p, index) => {
      const mediaArray = Array.isArray(p.media) ? p.media : [];
      const swiperSlides = mediaArray.map(item => {
        if (item.type === 'video') {
          return `
            <div class="swiper-slide">
              <video controls preload="metadata" class="w-100" style="height: 100%; object-fit: cover;">
                <source src="${item.url}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
            </div>
          `;
        } else {
          return `
            <div class="swiper-slide">
              <img src="${item.url}" alt="${p.title}" style="width: 100%; height: 100%; object-fit: cover;" />
            </div>
          `;
        }
      }).join('');

      const swiperId = `swiper-${index}`;
      const toggleId = `readmore-${index}`;

      const propertyCard = document.createElement('div');
      propertyCard.className = 'property-card';
      propertyCard.innerHTML = `
        <div class="property-media">
          <div class="swiper ${swiperId}">
            <div class="swiper-wrapper">
              ${swiperSlides}
            </div>
            <div class="swiper-pagination"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
          </div>
        </div>
        <div class="property-details">
          <div class="property-header">
            <h3 class="property-title">${p.title || 'Untitled Property'}</h3>
            ${p.plan === 'premium' ? '<span class="verified-badge">Verified</span>' : ''}
          </div>
          <div class="property-price">₦${p.price || 'N/A'}</div>
          <div class="property-location">
            <i class="fas fa-map-marker-alt"></i>
            <span>${p.location || 'Location not specified'}</span>
          </div>
          <p class="property-description">${p.description || 'No description available.'}</p>
          <a href="javascript:void(0);" class="read-more" onclick="toggleDetails('${toggleId}')">
            <i class="fas fa-chevron-down"></i> More Details
          </a>
          <div id="${toggleId}" class="extra-details">
            <div class="detail-item">
              <span class="detail-label">Posted By:</span>
              <span class="detail-value">${p.createdBy || 'N/A'}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Contact:</span>
              <span class="detail-value">${p.phoneNumber || 'N/A'}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Property ID:</span>
              <span class="detail-value">${p.id ? p.id.substring(0, 8) : 'N/A'}</span>
            </div>
          </div>
        </div>
      `;
      
      blogList.appendChild(propertyCard);

      setTimeout(() => {
        new Swiper(`.${swiperId}`, {
          loop: true,
          pagination: { el: `.${swiperId} .swiper-pagination`, clickable: true },
          navigation: { nextEl: `.${swiperId} .swiper-button-next`, prevEl: `.${swiperId} .swiper-button-prev` },
        });
      }, 0);
    });
  }

  // ==============================
  // Nigerian States and LGAs mapping
  // (Extend freely; structure is correct)
  // ==============================
  const nigeriaLGAs = {
    "abia": ["Aba North","Aba South","Arochukwu","Bende","Ikwuano","Isiala Ngwa North","Isiala Ngwa South","Isuikwuato","Obi Ngwa","Ohafia","Osisioma","Ugwunagbo","Ukwa East","Ukwa West","Umuahia North","Umuahia South","Umunneochi"],
    "adamawa": ["Demsa","Fufore","Ganye","Girei","Gombi","Guyuk","Hong","Jada","Lamurde","Madagali","Maiha","Mayo-Belwa","Michika","Mubi North","Mubi South","Numan","Shelleng","Song","Toungo","Yola North","Yola South"],
    "akwa-ibom": ["Abak","Eastern Obolo","Eket","Esit-Eket","Essien Udim","Etim Ekpo","Etinan","Ibeno","Ibesikpo Asutan","Ibiono-Ibom","Ikono","Ikot Abasi","Ikot Ekpene","Ini","Itu","Mbo","Mkpat-Enin","Nsit-Atai","Nsit-Ibom","Nsit-Ubium","Obot Akara","Okobo","Onna","Oron","Oruk Anam","Udung-Uko","Ukanafun","Uruan","Urue-Offong/Oruko","Uyo"],
    "anambra": ["Aguata","Anambra East","Anambra West","Anaocha","Awka North","Awka South","Ayamelum","Dunukofia","Ekwusigo","Idemili North","Idemili South","Ihiala","Njikoka","Nnewi North","Nnewi South","Ogbaru","Onitsha North","Onitsha South","Orumba North","Orumba South","Oyi"],
    "bauchi": ["Alkaleri","Bauchi","Bogoro","Damban","Darazo","Dass","Gamawa","Ganjuwa","Giade","Itas/Gadau","Jama'are","Katagum","Kirfi","Misau","Ningi","Shira","Tafawa Balewa","Toro","Warji","Zaki"],
    "bayelsa": ["Brass","Ekeremor","Kolokuma/Opokuma","Nembe","Ogbia","Sagbama","Southern Ijaw","Yenagoa"],
    "benue": ["Ado","Agatu","Apa","Buruku","Gboko","Guma","Gwer East","Gwer West","Katsina-Ala","Konshisha","Kwande","Logo","Makurdi","Obi","Ogbadibo","Ohimini","Oju","Okpokwu","Oturkpo","Tarka","Ukum","Ushongo","Vandeikya"],
    "borno": ["Abadam","Askira/Uba","Bama","Bayo","Biu","Chibok","Damboa","Dikwa","Gubio","Guzamala","Gwoza","Hawul","Jere","Kaga","Kala/Balge","Konduga","Kukawa","Kwaya Kusar","Mafa","Magumeri","Maiduguri","Marte","Mobbar","Monguno","Ngala","Nganzai","Shani"],
    "cross-river": ["Abi","Akamkpa","Akpabuyo","Bakassi","Bekwarra","Biase","Boki","Calabar Municipal","Calabar South","Etung","Ikom","Obanliku","Obubra","Obudu","Odukpani","Ogoja","Yakuur","Yala"],
    "delta": ["Aniocha North","Aniocha South","Bomadi","Burutu","Ethiope East","Ethiope West","Ika North East","Ika South","Isoko North","Isoko South","Ndokwa East","Ndokwa West","Okpe","Oshimili North","Oshimili South","Patani","Sapele","Udu","Ughelli North","Ughelli South","Ukwuani","Uvwie","Warri North","Warri South","Warri South West"],
    "ebonyi": ["Abakaliki","Afikpo North","Afikpo South","Ebonyi","Ezza North","Ezza South","Ikwo","Ishielu","Ivo","Izzi","Ohaozara","Ohaukwu","Onicha"],
    "edo": ["Akoko-Edo","Egor","Esan Central","Esan North-East","Esan South-East","Esan West","Etsako Central","Etsako East","Etsako West","Igueben","Ikpoba-Okha","Oredo","Orhionmwon","Ovia North-East","Ovia South-West","Owan East","Owan West","Uhunmwonde"],
    "ekiti": ["Ado Ekiti","Efon","Ekiti East","Ekiti South-West","Ekiti West","Emure","Gbonyin","Ido Osi","Ijero","Ikere","Ikole","Ilejemeje","Irepodun/Ifelodun","Ise/Orun","Moba","Oye"],
    "enugu": ["Aninri","Awgu","Enugu East","Enugu North","Enugu South","Ezeagu","Igbo-Etiti","Igbo-Eze North","Igbo-Eze South","Isi-Uzo","Nkanu East","Nkanu West","Nsukka","Oji River","Udenu","Udi","Uzo-Uwani"],
    "fct": ["Abaji","Abuja Municipal","Bwari","Gwagwalada","Kuje","Kwali"],
    "gombe": ["Akko","Balanga","Billiri","Dukku","Funakaye","Gombe","Kaltungo","Kwami","Nafada","Shongom","Yamaltu/Deba"],
    "imo": ["Aboh Mbaise","Ahiazu Mbaise","Ehime Mbano","Ezinihitte","Ideato North","Ideato South","Ihitte/Uboma","Ikeduru","Isiala Mbano","Isu","Mbaitoli","Ngor-Okpala","Njaba","Nkwerre","Nwangele","Obowo","Oguta","Ohaji/Egbema","Okigwe","Onuimo","Orlu","Orsu","Oru East","Oru West","Owerri Municipal","Owerri North","Owerri West"],
    "jigawa": ["Auyo","Babura","Biriniwa","Birnin Kudu","Buji","Dutse","Gagarawa","Garki","Gumel","Guri","Gwaram","Gwiwa","Hadejia","Jahun","Kafin Hausa","Kazaure","Kiri Kasama","Kiyawa","Maigatari","Malam Madori","Miga","Ringim","Roni","Sule Tankarkar","Taura","Yankwashi"],
    "kaduna": ["Birnin Gwari","Chikun","Giwa","Igabi","Ikara","Jaba","Jema'a","Kachia","Kaduna North","Kaduna South","Kagarko","Kajuru","Kaura","Kauru","Kubau","Kudan","Lere","Makarfi","Sabon Gari","Sanga","Soba","Zangon Kataf","Zaria"],
    "kano": ["Ajingi","Albasu","Bagwai","Bebeji","Bichi","Bunkure","Dala","Dambatta","Dawakin Kudu","Dawakin Tofa","Doguwa","Fagge","Gabasawa","Garko","Garun Mallam","Gaya","Gezawa","Gwale","Gwarzo","Kabo","Kano Municipal","Karaye","Kibiya","Kiru","Kumbotso","Kunchi","Kura","Madobi","Makoda","Minjibir","Nasarawa","Rano","Rimin Gado","Rogo","Shanono","Sumaila","Takai","Tarauni","Tofa","Tsanyawa","Tudun Wada","Ungogo","Warawa","Wudil"],
    "katsina": ["Bakori","Batagarawa","Batsari","Baure","Bindawa","Charanchi","Dandume","Danja","Dan Musa","Daura","Dutsi","Dutsin Ma","Faskari","Funtua","Ingawa","Jibia","Kafur","Kaita","Kankara","Kankia","Katsina","Kurfi","Kusada","Mai'Adua","Malumfashi","Mani","Mashi","Matazu","Musawa","Rimi","Sabuwa","Safana","Sandamu","Zango"],
    "kebbi": ["Aleiro","Arewa Dandi","Argungu","Augie","Bagudo","Birnin Kebbi","Bunza","Dandi","Fakai","Gwandu","Jega","Kalgo","Koko/Besse","Maiyama","Ngaski","Sakaba","Shanga","Suru","Wasagu/Danko","Yauri","Zuru"],
    "kogi": ["Adavi","Ajaokuta","Ankpa","Bassa","Dekina","Ibaji","Idah","Igalamela-Odolu","Ijumu","Kabba/Bunu","Kogi","Lokoja","Mopa-Muro","Ofu","Ogori/Magongo","Okehi","Okene","Olamaboro","Omala","Yagba East","Yagba West"],
    "kwara": ["Asa","Baruten","Edu","Ekiti","Ifelodun","Ilorin East","Ilorin South","Ilorin West","Irepodun","Isin","Kaiama","Moro","Offa","Oke Ero","Pategi"],
    "lagos": ["Agege","Ajeromi-Ifelodun","Alimosho","Amuwo-Odofin","Apapa","Badagry","Epe","Eti-Osa","Ibeju-Lekki","Ifako-Ijaiye","Ikeja","Ikorodu","Kosofe","Lagos Island","Lagos Mainland","Mushin","Ojo","Oshodi-Isolo","Shomolu","Surulere"],
    "nasarawa": ["Akwanga","Awe","Doma","Karu","Keana","Keffi","Kokona","Lafia","Nasarawa","Nasarawa Egon","Obi","Toto","Wamba"],
    "niger": ["Agaie","Agwara","Bida","Borgu","Bosso","Chanchaga","Edati","Gbako","Gurara","Katcha","Kontagora","Lapai","Lavun","Magama","Mariga","Mashegu","Mokwa","Muya","Paikoro","Rafi","Rajau","Shiroro","Suleja","Tafa","Wushishi"],
    "ogun": ["Abeokuta North","Abeokuta South","Ado-Odo/Ota","Egbado North","Egbado South","Ewekoro","Ifo","Ijebu East","Ijebu North","Ijebu North East","Ijebu Ode","Ikenne","Imeko Afon","Ipokia","Obafemi Owode","Odeda","Odogbolu","Ogun Waterside","Remo North","Sagamu"],
    "ondo": ["Akoko North-East","Akoko North-West","Akoko South-East","Akoko South-West","Akure North","Akure South","Ese Odo","Idanre","Ifedore","Ilaje","Ile Oluji/Okeigbo","Irele","Odigbo","Okitipupa","Ondo East","Ondo West","Ose","Owo"],
    "osun": ["Atakunmosa East","Atakunmosa West","Aiyedaade","Aiyedire","Boluwaduro","Boripe","Ede North","Ede South","Egbedore","Ejigbo","Ife Central","Ife East","Ife North","Ife South","Ifedayo","Ifelodun","Ila","Ilesa East","Ilesa West","Irepodun","Irewole","Isokan","Iwo","Obokun","Odo Otin","Ola Oluwa","Olorunda","Oriade","Orolu","Osogbo"],
    "oyo": ["Afijio","Akinyele","Atiba","Atisbo","Egbeda","Ibadan North","Ibadan North-East","Ibadan North-West","Ibadan South-East","Ibadan South-West","Ibarapa Central","Ibarapa East","Ibarapa North","Ido","Irepo","Iseyin","Itesiwaju","Iwajowa","Kajola","Lagelu","Ogbomosho North","Ogbomosho South","Ogo Oluwa","Olorunsogo","Oluyole","Ona Ara","Orelope","Ori Ire","Oyo East","Oyo West","Saki East","Saki West","Surulere"],
    "plateau": ["Barkin Ladi","Bassa","Bokkos","Jos East","Jos North","Jos South","Kanam","Kanke","Langtang North","Langtang South","Mangu","Mikang","Pankshin","Qua'an Pan","Riyom","Shendam","Wase"],
    "rivers": ["Abua–Odual","Ahoada East","Ahoada West","Akuku-Toru","Andoni","Asari-Toru","Bonny","Degema","Eleme","Emohua","Etche","Gokana","Ikwerre","Khana","Obio-Akpor","Ogba–Egbema–Ndoni","Ogu–Bolo","Okrika","Omuma","Opobo–Nkoro","Oyigbo","Port Harcourt","Tai"],
    "sokoto": ["Binji","Bodinga","Dange Shuni","Gada","Goronyo","Gudu","Gwadabawa","Illela","Isa","Kebbe","Kware","Rabah","Sabon Birni","Shagari","Silame","Sokoto North","Sokoto South","Tambuwal","Tangaza","Tureta","Wamakko","Wurno","Yabo"],
    "taraba": ["Ardo Kola","Bali","Donga","Gashaka","Gassol","Ibi","Jalingo","Karim Lamido","Kumi","Lau","Sardauna","Takum","Ussa","Wukari","Yorro","Zing"],
    "yobe": ["Bade","Bursari","Damaturu","Fika","Fune","Geidam","Gujba","Gulani","Jakusko","Karasuwa","Machina","Nangere","Nguru","Potiskum","Tarmuwa","Yunusari","Yusufari"],
    "zamfara": ["Anka","Bakura","Birnin Magaji/Kiyaw","Bukkuyum","Bungudu","Gummi","Gusau","Kaura Namoda","Maradun","Maru","Shinkafi","Talata Mafara","Tsafe","Zurmi"]
  };

  // Populate LGA dropdown when a state is chosen
  function populateLGAs() {
    const state = stateInput.value;
    locationInput.innerHTML = '<option value="" selected>All LGAs</option>'; // reset

    const lgas = nigeriaLGAs[state];
    if (state && Array.isArray(lgas) && lgas.length) {
      lgas.forEach(lga => {
        const opt = document.createElement('option');
        opt.value = lga.toLowerCase();
        opt.textContent = lga;
        locationInput.appendChild(opt);
      });
      locationInput.disabled = false;
    } else {
      locationInput.disabled = true;
    }
  }

  function applyFilters() {
    const query = searchInput.value.trim().toLowerCase();
    const maxPrice = parseFloat(priceInput.value);
    const selectedLGA = locationInput.value.trim().toLowerCase();
    const selectedState = stateInput.value.trim().toLowerCase();

    const filtered = allProperties.filter(p => {
      const title = (p.title || '').toLowerCase();
      const location = (p.location || '').toLowerCase();
      const price = Number(p.price) || 0;

      const matchesTitleQuery = !query || title.includes(query);
      const matchesPrice = isNaN(maxPrice) || price <= maxPrice;

      // If an LGA is selected, we filter by LGA (keeps previous logic style)
      const matchesLGA = !selectedLGA || location.includes(selectedLGA);

      // If only state is selected (and no LGA), try to match state text in location
      const stateOnly = selectedState && !selectedLGA;
      const stateToken = selectedState.replace(/-/g, ' ');
      const matchesStateOnly = !stateOnly || location.includes(selectedState) || location.includes(stateToken) || (selectedState === 'fct' && (location.includes('abuja') || location.includes('fct')));

      return matchesTitleQuery && matchesPrice && matchesLGA && matchesStateOnly;
    });

    renderProperties(filtered);
  }

  // Firestore: initialize with all properties
  db.collection('properties')
    .orderBy('createdAt', 'asc')
    .onSnapshot(snapshot => {
      allProperties = snapshot.docs.map(doc => {
        const data = doc.data();
        data.id = doc.id;
        data.priority = !!data.priority;
        data.plan = data.plan || 'free';
        return data;
      });

      // Sort by premium first, then priority, then date (newest first)
      allProperties.sort((a, b) => {
        if (a.plan === 'premium' && b.plan !== 'premium') return -1;
        if (a.plan !== 'premium' && b.plan === 'premium') return 1;

        if (a.priority !== b.priority) return b.priority - a.priority;

        const aTime = a.createdAt ? a.createdAt.seconds : 0;
        const bTime = b.createdAt ? b.createdAt.seconds : 0;
        return bTime - aTime;
      });

      applyFilters();
    });

  // Event listeners
  searchInput.addEventListener('input', applyFilters);
  priceInput.addEventListener('input', applyFilters);
  locationInput.addEventListener('change', applyFilters);
  stateInput.addEventListener('change', () => { populateLGAs(); applyFilters(); });
  searchBtn.addEventListener('click', applyFilters);

  // On load: ensure LGA select reflects current state (empty)
  populateLGAs();
</script>

</body>
</html>
